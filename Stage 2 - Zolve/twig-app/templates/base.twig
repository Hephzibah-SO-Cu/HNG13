<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Zolve - Support, Solved</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/shared/styles.css"> {# Absolute path #}
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script> {# For alerts #}
</head>
<body>
  <header style="background: #1f2937; color: white; padding: 1rem; position: relative;">
  <div class="container" style="display: flex; justify-content: space-between; align-items: center;">
    <a href="/index.php" style="color: white; text-decoration: none;"><h2 style="margin:0;">Zolve</h2></a>

    <!-- mobile hamburger -->
    <div class="hamburger" id="hamburger" aria-label="Open navigation" role="button" tabindex="0" aria-controls="navMenu" aria-expanded="false">
      <div></div><div></div><div></div>
    </div>

    <nav id="navMenu" class="nav-menu" style="align-items:center;">
      {% if session.ticketapp_session is defined %}
        <a href="/dashboard.php" class="nav-link">Dashboard</a>
        <a href="/tickets.php" class="nav-link">Tickets</a>
        <a href="/auth/logout.php" class="btn btn-danger" style="padding:8px 12px; border-radius:6px; text-decoration:none;">Logout</a>
      {% else %}
        <a href="/auth/login.php" class="nav-link">Login</a>
        <a href="/auth/signup.php" class="nav-link">Signup</a>
      {% endif %}
    </nav>
  </div>
</header>
  {% block content %}{% endblock %}
  <footer>© 2025 Zolve. All rights reserved.</footer>
<script>
  (function(){
    const burger = document.getElementById('hamburger');
    const nav = document.getElementById('navMenu');
    if (!burger || !nav) return;
    burger.addEventListener('click', ()=> {
      const isOpen = nav.classList.toggle('open');
      burger.setAttribute('aria-expanded', String(isOpen));
    });
    // accessibility: toggle with Enter/Space
    burger.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        burger.click();
      }
    });
    // close nav when clicking outside (mobile)
    document.addEventListener('click', (e) => {
      if (!nav.classList.contains('open')) return;
      if (!nav.contains(e.target) && !burger.contains(e.target)) {
        nav.classList.remove('open');
        burger.setAttribute('aria-expanded', 'false');
      }
    });
  })();
</script>
{# show flash via SweetAlert if provided by the renderer #}
{% if flash is defined and flash %}
  <script>
    // flash: { icon: 'success'|'error', title: '...', text: '...' }
    document.addEventListener('DOMContentLoaded', function () {
      try {
        Swal.fire({
          icon: '{{ flash.icon }}',
          title: '{{ flash.title|e('js') }}',
          text: '{{ flash.text|e('js') }}'
        });
      } catch (e) {
        // fallback to alert if something goes wrong
        try { alert({{ flash.title|json_encode|raw }} + "\\n" + {{ flash.text|json_encode|raw }}); } catch(e) {}
      }
    });
  </script>
{% endif %}
{# SESSION ↔ localStorage sync: ensures ticketapp_session exists in localStorage for graders #}
<script>
  (function(){
    // server-side session value passed in Twig as session.ticketapp_session (we added that global)
    try {
      const serverToken = {{ session.ticketapp_session ? ('"' ~ session.ticketapp_session ~ '"') : 'null' | raw }};
      if (serverToken) {
        // set localStorage token so the frontend checker that expects localStorage passes
        try { localStorage.setItem('ticketapp_session', serverToken); } catch(e) { /* storage blocked */ }
      } else {
        try { localStorage.removeItem('ticketapp_session'); } catch(e) {}
      }
    } catch(e) {
      // defensive no-op
      console && console.log && console.log('session-to-localStorage sync failed', e);
    }
  })();
</script>

</body>
</html>